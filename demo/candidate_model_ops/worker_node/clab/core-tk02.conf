system {
    host-name core-tk02;
    root-authentication {
        encrypted-password "$6$vOte4zs5$j1X3fElYvJSt8VPNXx2KzRNrZIkp9CeRX83/W4wQo5K4Tl/MHZeMcvbymEzm9/2ya3S4hU993YDSLY26ROGnW/"; ## SECRET-DATA
    }
    login {
        user vrnetlab {
            uid 2000;
            class super-user;
            authentication {
                encrypted-password "$6$CDmzGe/d$g43HmhI3FA.21JCYppnTg1h4q/JO4DOHSICLhhavqBem5zUTgKEcg5m9tBG1Ik6qmfb7L3v.wgj4/DkfgZejO0"; ## SECRET-DATA
            }
        }
    }
    services {
        ssh;
        netconf {
            ssh;
        }
    }
}
interfaces {
    /*ge-0/0/0.0*/
    eth1 {
        description "to_Seg-192.168.1.0-24_Ethernet2"
        unit 0 {
            family inet {
                address 192.168.1.102/24;
            }
        }
    }
    /*lo0.0*/
    lo0 {
        unit 0 {
            family inet {
                address 192.168.255.102/32;
            }
        }
    }
}
routing-options {
    rib inet.0 {
        static {
            route 0.0.0.0/0 {
                discard;
                preference 5;
                metric 0;
            }
            route 10.100.0.0/16 {
                discard;
                preference 5;
                metric 0;
            }
            route 10.110.0.0/20 {
                discard;
                preference 5;
                metric 0;
            }
            route 10.120.0.0/17 {
                discard;
                preference 5;
                metric 0;
            }
            route 10.130.0.0/21 {
                discard;
                preference 5;
                metric 0;
            }
            route 172.31.255.1/32 {
                discard;
                preference 5;
                metric 0;
            }
        }
    }
}
routing-options {
    router-id 192.168.255.102;
}

routing-options {
    router-id 192.168.255.102;
}

routing-options {
    autonomous-system 65500;
    confederation 65518 members [ 65500 ];
}
policy-options {
    community aggregated members 65518:1;
    policy-statement ipv4-core {
        term bgp {
            from {
                protocol bgp;
            }
            then {
                accept;
            }
        }
        term aggregate-static {
            from {
                protocol static;
                rib inet.0;
                route-filter 10.100.0.0/16 exact;
                route-filter 10.110.0.0/20 exact;
                route-filter 10.120.0.0/17 exact;
                route-filter 10.130.0.0/21 exact;
                route-filter 172.31.255.1/32 exact;
            }
            then {
                community set aggregated;
                next-hop 172.31.255.1;
                accept;
            }
        }
        then {
            reject;
        }
    }
    policy-statement ipv4-full {
        term bgp {
            from {
                protocol bgp;
            }
            then {
                accept;
            }
        }
        term aggregate-static {
            from {
                protocol static;
                rib inet.0;
            }
            then {
                community set aggregated;
                next-hop 172.31.255.1;
                accept;
            }
        }
        term default-static {
            from {
                protocol static;
                rib inet.0;
                route-filter 0.0.0.0/0 exact;
            }
            then {
                next-hop 172.31.255.1;
                accept;
            }
        }
        then {
            reject;
        }
    }
}
protocols {
    bgp {
        family inet {
            unicast;
        }
        group Edge-TK {
            family inet {
                unicast;
            }
            peer-as 65500;
            local-as 65500;
            type internal;
            hold-time 90;
            cluster 192.168.255.102;
            neighbor 192.168.255.11 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
            cluster 192.168.255.102;
            neighbor 192.168.255.1 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
            cluster 192.168.255.102;
            neighbor 192.168.255.2 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
            cluster 192.168.255.102;
            neighbor 192.168.255.3 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
        }
        group Edge-TK {
            family inet {
                unicast;
            }
            peer-as 65500;
            local-as 65500;
            type internal;
            hold-time 90;
            cluster 192.168.255.102;
            neighbor 192.168.255.11 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
            cluster 192.168.255.102;
            neighbor 192.168.255.1 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
            cluster 192.168.255.102;
            neighbor 192.168.255.2 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
            cluster 192.168.255.102;
            neighbor 192.168.255.3 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
        }
        group Edge-TK {
            family inet {
                unicast;
            }
            peer-as 65500;
            local-as 65500;
            type internal;
            hold-time 90;
            cluster 192.168.255.102;
            neighbor 192.168.255.11 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
            cluster 192.168.255.102;
            neighbor 192.168.255.1 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
            cluster 192.168.255.102;
            neighbor 192.168.255.2 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
            cluster 192.168.255.102;
            neighbor 192.168.255.3 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
        }
        group Edge-TK {
            family inet {
                unicast;
            }
            peer-as 65500;
            local-as 65500;
            type internal;
            hold-time 90;
            cluster 192.168.255.102;
            neighbor 192.168.255.11 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
            cluster 192.168.255.102;
            neighbor 192.168.255.1 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
            cluster 192.168.255.102;
            neighbor 192.168.255.2 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
            cluster 192.168.255.102;
            neighbor 192.168.255.3 {
                local-address 192.168.255.102;
                export ipv4-full;
            }
        }
        group INT {
            family inet {
                unicast;
            }
            peer-as 65500;
            local-as 65500;
            type internal;
            hold-time 90;
            neighbor 192.168.255.101 {
                local-address 192.168.255.102;
                export ipv4-core;
            }
        }
    }
}
protocols {
    ospf {
        area 0.0.0.0 {
            interface eth1 {
                metric 1;
                priority 10;
                hello-interval 10;
                dead-interval 40;
            }
            interface lo0.0 {
                priority 10;
                hello-interval 10;
                dead-interval 40;
            }
        }
    }
}
